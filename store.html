<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luz Viva MX</title>
    <script src="shop.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
    <link rel="stylesheet" href="style.css">


    <style>

        :root{
            --font-size-description: 1rem;
            --font-size-normal: 1.2rem;
            --font-size-emphasis: 1.4rem;
            --font-size-emphasis-medium: 1.6rem;
            --font-size-emphasis-giant: 4rem;

            --font-size-title-1: 2.4rem;
            --font-size-title-2: 1.4rem;

            --color-primary: black;
            --color-secondary: #7d7d7d;

            --background-sheet: white;
            --background-sheet-secondary: #f5f5f5;
            --background-sheet-inset: #f0f0f0;

            --border-color-light: #dcdcdc;

            --blue: rgb(0, 122, 255)

        }

        @media screen and (max-width: 800px){
            :root{
                --font-size-title-2: 1.2rem
            }
        }
        /*
            --background-sheet: #303030;

        */











        body{
            color: var(--color-primary);
            overflow: auto;
            pointer-events: all;
        }
        body.overlay{
            overflow: hidden;
            pointer-events: none;
        }

        #cart-cont{
            background-color: var(--background-sheet-secondary);
            padding: 8px;
            position: fixed;
            height: 100%;
            max-width: 100%;
            overflow: auto;
            pointer-events: all;
            z-index: 2;
        }

        #cart-cont>*{
            flex-shrink: 0;
        }

        #store-cont{
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            font-family: Arial, Helvetica, sans-serif;
            flex-direction: row;
            padding: 0px;
        }


        .product_card{
            border: 1px solid var(--border-color-light);
            color: white;
            margin: 8px;
            width: 100%;
            max-width: 320px;
            padding: 16px;
            box-sizing: border-box;
            height: 320px;
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-end;
        }
        .product_card:hover{
            transform: scale(1.025);
            box-shadow: 0 1px 2px rgba(0,0,0,0.0625), 0 8px 12px rgba(0,0,0,0.125);
            background-size: 110% 110%;
        }
        .product_card [name="name"]{
            font-size: var(--font-size-normal);
            margin: 4px
        }
        .product_card [name="price"]{
            font-size: var(--font-size-normal);

            margin: 4px;
            padding: 4px 8px;
            background: rgb(160,160,160);
            color: white;
            display: inline-block;
            font-weight: 600;
            border-radius: 4px;
        }


        .product_page{
            background: var(--background-sheet);
            position: fixed;
            display: flex;
            flex-wrap: wrap;
            top: 16px; left: 16px; right: 16px; bottom: 16px;
            box-shadow: 0px 0px 16px 24px rgba(0,0,0,0.5);
            overflow: auto;
            pointer-events: all;
            z-index: 2;
        }
        .product_page .product_page_image, .product_page .product_page_details {
            padding: 16px;
            flex: 1;
        }
        .product_page_image{
            background-position: center;
            background-size: cover;
            background-repeat: no-repeat;
            height: auto;
            max-width: 80vh;
        }
        .product_page .product_page_details{
            min-width: 400px;
            box-sizing: border-box;
            align-items: center;
            display: flex;
            flex-direction: column;
        }

        .product_page .product_page_details * {
            max-width: 800px;
            width: 100%;
            flex-grow: 0;
        }
        .product_page_details [name="btn-close"], #cart-cont [name="btn-close"]{
            color: var(--color-secondary);
            height: 64px;
            width: 64px;
            border-radius: 32px;
            margin: 16px 0px;
            margin-left: auto;
            flex-shrink: 0;
            font-family: 'Material Icons';
            text-align: center;
            line-height: 64px;
            font-size: 60px;
        }

        [name="btn-close"]::before{
            content: 'close';
        }

        .product_page_details [name="name"]{
            font-size: var(--font-size-title-1);
            margin: 8px;
        }
        .product_page_details [name="description"]{
            font-size: var(--font-size-emphasis);
            margin: 16px 8px;
        }

        .product_page_details [name="additional-details"]{
            background: var(--background-sheet-inset);
            margin: 8px;
            border-radius: 8px;
            display: flex;
        }
        .product_page_details [name="additional-details"] .detail{
            padding: 16px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .product_page_details [name="additional-details"] .detail span{
            display: block;
            text-align: center;
        }

        .product_page_details [name="additional-details"] .detail [name="detail_value"]{
            font-size: var(--font-size-emphasis);
        }
        .product_page_details [name="additional-details"] .detail [name="detail_key"]{
            color: #7d7d7d;
            font-size: var(--font-size-normal);
            font-weight: 600;
        }

        .product_page_details [name="price"]{
            color: var(--color-secondary);
            font-size: var(--font-size-emphasis-giant);
            margin: 24px 8px;
            font-weight: 400;
        }

        .product_page_details [name="cart-status"]{

            font-size: var(--font-size-normal);
            background: var(--blue);

            padding: 16px;
            margin: 8px;
            font-weight: 600;
            border: none;
            appearance: none;
            color: white;
            border-radius: 8px;
            box-sizing: border-box;
        }

        .product_page_details [name="cart-status"].remove{
            background: red;
        }

        .product_row{
            border: 0.5px solid var(--border-color-light);
            background: var(--background-sheet);
            display: flex;
            align-items: center;
        }

        .product_row>*{
            margin: 8px;
        }

        .product_row [name="picture"]{
            width: auto;
            height: auto;
            max-height: 120px;
            max-width: 120px;
        }

        .product_row [name="details"]{
            flex: 1;
        }

        .product_row [name="name"]{
            font-size: var(--font-size-title-2);
            margin: 0px;
        }

        .product_row [name="price"]{
            font-size: var(--font-size-emphasis-medium);
            margin-left: 16px;
        }

        .product_row [name="additional-details"]{
           color: var(--color-secondary);
        }
        .product_row [name="additional-details"] summary {
            font-size: var(--font-size-normal);
            margin: 4px 0px;
        }
        .product_row [name="additional-details"] p{
            font-size: var(--font-size-description);
            margin: 0px;
            padding: 4px 0px;
        }

        #cart-cont .total{
            border-top: 1px dashed var(--color-primary);
            color: var(--color-primary);
            display: flex;
            margin: 16px 8px;
            padding: 16px 0px;
            align-items: center;
            box-sizing: border-box;
        }

        #cart-cont .total [name="title"]{
            font-size: var(--font-size-emphasis-medium);
            flex: 1;
            margin: 0;
        }

        #cart-cont .total [name="total"]{
            font-size: var(--font-size-emphasis-giant);
            font-weight: 600;
        }

        #checkout{
            display: flex;
            flex-direction: column;
            align-items: center;

        }

        #checkout h2{
            font-size: var(--font-size-emphasis-medium);
            margin: 8px;
            max-width: 800px;
            width: 100%;
        }

        #checkout div{

            padding: 16px 8px;
            /* max-width: 800px; */
            width: 100%;
        }

        #checkout legend{
            color: var(--color-secondary);
            font-size: var(--font-size-emphasis);
            font-weight: 600;
        }

        #checkout input{
            margin: 2px 0px;
            padding: 8px;
            font-size: 1.2em;
            box-sizing: border-box;
            width: 100%;
            border: 0.5px solid var(--color-secondary);
        }

        










        @media screen and (max-width: 800px){
            .product_card{
                max-width: 100%;
                height: 100vw;
            }
            .product_page{
                top: 0; left: 0; right: 0; bottom: 0;
                align-content: flex-start;

            }
            .product_page .product_page_image{
                min-width: auto;
                max-width: 100%;
                flex-basis: 100%;
                height: 80vw;
            }
            .product_page .product_page_details{
                width: 100%;
                min-width: auto;
            }
            .product_row [name="picture"]{
                max-width: 80px;
                max-height: 80px;
            }

        }

        .paypal-buttons{
            margin: 8px !important;
        }

        .paypal-buttons iframe{
            position: relative !important;
        }

        



        


       #cart-button button{
           background: var(--blue);
           font-size: var(--font-size-normal);
           font-weight: 600;
           color: white;
           border-radius: 4px;
       }

       header{
           color: white;
           background: #F50087;
       }
    </style>

</head>
<body>


    <header>
        <nav>
            <img src="logo.png" alt="">

            <h1>Tienda</h1>
            <ul>
                <li> Uno </li>
                <li> Dos </li>
                <li id="cart-button"> <button>Carrito</button> </li>
              </ul>
        </nav>
    </header>


    <section id="store-cont">
    </section>

    
    <script src="https://www.paypal.com/sdk/js?client-id=sb"></script>
    <script>

        
        let store = new Store({
            checkoutAction: 'https://script.google.com/macros/s/AKfycbyoK3s8URHcW5iuttdiLBOW86VavA3xDab9bdxixO6JtzQPpg/exec'
        });

        async function getData(){
            let request = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRsups55Y4L25beVTJ2jPZUbhvfe7Ir1TXTgAA4ELyqh2JFu5zYHxclTj8-3Wqacvw5829WTRfcGT4i/pub?output=csv');
            let response = await request.text()
            return response;
        }


        getData().then(response=>{
            let arr = response.split('\n');
            let headers = arr[0].split(',')
            let parsed = [];
            arr.splice(0,1)
            arr.forEach(l=>{
                let stringRow = l.split(',');
                let objRow = {}
                stringRow.forEach((l,i)=>{  objRow[ headers[i] ] = l })
                parsed.push(objRow)

                store.addProduct( new Product({
                    id: objRow['id'], 
                    name: objRow['Nombre'],
                    price: objRow['Precio'],
                    image: objRow['Foto'],
                    details: {
                        'Modelo': objRow['Detalles: Modelo'],
                        'Envío': objRow['Detalles: Envío'],
                        'Existencia': objRow['Detalles: Existencia\r']
                    }
                }) )

            })
            console.table(parsed); 
            store.showProducts()
            store.addToCart( store.products[0] )
        })

        document.querySelector('#cart-button').addEventListener('click', ()=>{
            store.showCart()
        })




    </script>

</body>
</html>